<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Groomers Admin</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'corduroyserver/styles.css' %}">
</head>
<body>
    <div class="container">
        <h1>Groomer Admin</h1>
        
        {% if form.errors %}
            <p class="error">Please correct the errors below:</p>
        {% endif %}
        
        <form method="post">
            {% csrf_token %}
            <table>
                <tr>
                    <!-- Location will not appear unless there is at least one trail define in that location -->
                    <td><label for="location">Location:</label></td>
                    <td>
                        <select id="location" name="location" onchange="updateTrails()">
                            <option value="">Select Location</option>
                            {% for location in trails_by_location.keys %}
                                <option value="{{ location }}">{{ location }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="id_trail">Trail Name:</label></td>
                    <td>
                        <select id="id_trail" name="trail">
                            <option value="">Select Trail</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="id_report">Report:</label></td>
                    <td>{{ form.report }}</td>
                </tr>
                <tr>
                    <td colspan="2">
                        <button type="submit">Submit Report</button>
                    </td>
                </tr>
            </table>
        </form>
        
        <p><a href="{% url 'homepage' %}">Back to Home</a></p>
    </div>

    <script>
        const trailsByLocation = {{ trails_by_location|safe }};
        
        function updateTrails() {
            const location = document.getElementById('location').value;
            const trailSelect = document.getElementById('id_trail');

            // Clear existing options
            trailSelect.innerHTML = '<option value="">Select Trail</option>';

            // Populate trails based on selected location
            if (trailsByLocation[location]) {
                trailsByLocation[location].forEach(trail => {
                    const option = document.createElement('option');
                    option.value = trail.id;
                    option.textContent = trail.name;
                    trailSelect.appendChild(option);
                });
            }
        }
    </script>
</body>
</html>

